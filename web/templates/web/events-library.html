{% extends 'base.html' %}

{% load static tz %}

{% block extra_head %}
<script src="{% static 'web/js/htmx.min.js' %}" defer></script>
{% endblock extra_head %}

{% block content %}

<br>

<h1>{{ title }}</h1>

<div class="bg-green-600 text-white p-4 lg:p-8 rounded mx-auto lg:w-8/12 lg:flex justify-center font-bold prose prose-sm lg:prose-lg mb-4">
  <svg width="204" height="163" viewBox="0 0 204 163" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-16 w-auto mx-auto flex-shrink-0 lg:mr-6 mb-4"><circle cx="102.706" cy="82.353" r="80" fill="#B9EDB6"></circle><path d="M175.073 33.512l-.409.802.409-.802c-.341-.174-.695-.238-1.051-.267-.337-.027-.746-.027-1.221-.027H27.904c-.474 0-.884 0-1.22.027-.357.03-.71.093-1.051.267a2.7 2.7 0 00-1.18 1.18c-.174.34-.238.694-.267 1.05-.027.337-.027.747-.027 1.22v95.487c0 .474 0 .883.027 1.221.03.355.093.709.267 1.05a2.7 2.7 0 001.18 1.18c.34.173.694.237 1.05.267.337.027.746.027 1.22.027h144.899c.474 0 .883 0 1.22-.027.356-.03.71-.094 1.051-.267a2.702 2.702 0 001.18-1.18c.173-.341.237-.695.266-1.05.028-.337.028-.747.028-1.221V36.963c0-.475 0-.884-.028-1.22-.029-.357-.093-.71-.266-1.051a2.701 2.701 0 00-1.18-1.18z" fill="#fff" stroke="#2DAA2A" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path><rect x="133.248" y="23.222" width="8.458" height="17.608" rx="3" fill="#DBF5D6" stroke="#2DAA2A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><rect x="58.738" y="23.222" width="8.458" height="17.608" rx="3" fill="#DBF5D6" stroke="#2DAA2A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect><path d="M34.437 72.866h23.53V91.69h-23.53V72.866zM34.437 54.902h23.53v7.843h-23.53v-7.843zM34.437 94.118h23.53v18.823h-23.53V94.118zM61.504 72.866h23.53V91.69h-23.53V72.866zM61.504 54.902h23.53v7.843h-23.53v-7.843zM61.504 94.118h23.53v18.823h-23.53V94.118zM88.571 72.866h23.53V91.69h-23.53V72.866zM88.571 54.902h23.53v7.843h-23.53v-7.843zM88.571 94.118h23.53v18.823h-23.53V94.118zM115.638 72.866h23.53V91.69h-23.53V72.866zM115.638 54.902h23.53v7.843h-23.53v-7.843zM115.638 94.118h23.53v18.823h-23.53V94.118zM142.706 72.866h23.529V91.69h-23.529V72.866zM142.706 54.902h23.529v7.843h-23.529v-7.843zM142.706 94.118h23.529v18.823h-23.529V94.118z" fill="#DBF5D6"></path><ellipse cx="71.311" cy="84.981" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M84.89 81.206c0 .294-.124.588-.35.8l-10.742 10.13a1.25 1.25 0 01-.849.33 1.25 1.25 0 01-.85-.33l-6.22-5.866a1.11 1.11 0 01-.35-.8c0-.295.125-.59.35-.802l1.699-1.601a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l3.672 3.474 8.194-7.738a1.25 1.25 0 01.85-.33c.312 0 .624.118.85.33l1.698 1.602c.225.212.35.506.35.8z" fill="#2DAA2A"></path><ellipse cx="126.474" cy="82.89" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M140.054 79.114c0 .295-.125.59-.35.801l-10.742 10.13a1.25 1.25 0 01-.849.33 1.25 1.25 0 01-.85-.33l-6.22-5.866a1.11 1.11 0 01-.35-.801c0-.295.125-.589.35-.801l1.698-1.602c.225-.212.538-.33.85-.33.312 0 .624.118.849.33l3.673 3.475 8.194-7.739a1.25 1.25 0 01.849-.33c.313 0 .625.118.85.33l1.698 1.602c.225.212.35.507.35.801z" fill="#2DAA2A"></path><ellipse cx="151.311" cy="103.805" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M164.891 100.029c0 .295-.125.589-.35.801l-10.743 10.129c-.224.212-.537.33-.849.33a1.25 1.25 0 01-.849-.33l-6.221-5.865a1.11 1.11 0 01-.35-.801c0-.295.125-.589.35-.801l1.699-1.602a1.25 1.25 0 01.849-.33c.313 0 .625.118.85.33l3.672 3.475 8.194-7.739a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l1.699 1.602c.225.212.35.507.35.801z" fill="#2DAA2A"></path><ellipse cx="98.37" cy="103.805" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M111.95 100.029c0 .295-.125.589-.35.801l-10.742 10.129c-.225.212-.538.33-.85.33a1.25 1.25 0 01-.85-.33l-6.22-5.865a1.11 1.11 0 01-.35-.801c0-.295.125-.589.35-.801l1.699-1.602a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l3.672 3.475 8.194-7.739a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l1.699 1.602c.225.212.35.507.35.801z" fill="#2DAA2A"></path><ellipse cx="45.428" cy="80.275" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M59.008 76.5c0 .294-.125.589-.35.8L47.917 87.43a1.25 1.25 0 01-.85.33 1.25 1.25 0 01-.849-.33l-6.22-5.866a1.11 1.11 0 01-.35-.8c0-.295.125-.59.35-.801l1.699-1.602a1.25 1.25 0 01.849-.33c.312 0 .624.118.85.33l3.672 3.474 8.194-7.738a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l1.699 1.602c.224.212.35.506.35.8z" fill="#2DAA2A"></path><ellipse cx="72.879" cy="105.112" rx="8.605" ry="8.611" fill="#B9EDB6"></ellipse><path fill-rule="evenodd" clip-rule="evenodd" d="M86.46 101.336c0 .295-.125.589-.35.801l-10.743 10.13a1.25 1.25 0 01-.85.329 1.25 1.25 0 01-.849-.329l-6.22-5.866a1.11 1.11 0 01-.35-.801c0-.294.125-.589.35-.801l1.699-1.602a1.25 1.25 0 01.85-.329c.311 0 .624.117.849.329l3.672 3.475 8.194-7.738a1.25 1.25 0 01.85-.33c.312 0 .624.118.849.33l1.699 1.601c.225.212.35.507.35.801z" fill="#2DAA2A"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M20.868 108.526a4.737 4.737 0 001.836-1.713 4.894 4.894 0 00.746-2.372 4.587 4.587 0 00-.548-2.422 4.713 4.713 0 00-1.712-1.829 4.84 4.84 0 00-2.395-.728 4.74 4.74 0 00-2.447.563 4.614 4.614 0 00-1.815 1.703 4.892 4.892 0 00-.714 2.381 4.705 4.705 0 00.559 2.442c.626 1.178 1.569 1.958 2.83 2.341 1.26.384 2.48.262 3.66-.366zm-8.603-16.18c2.196-1.169 4.497-1.707 6.904-1.618 2.38.105 4.585.776 6.617 2.014 2.046 1.265 3.651 2.993 4.816 5.183.888 1.67 1.495 3.806 1.822 6.406.261 2.214.328 4.725.201 7.532a88.908 88.908 0 01-.765 7.202 72.488 72.488 0 01-.956 5.355l-.471 2.094-2-.78a73.055 73.055 0 01-4.974-2.202 88.811 88.811 0 01-6.399-3.393c-2.398-1.464-4.442-2.924-6.13-4.379-1.974-1.725-3.405-3.422-4.293-5.093-1.165-2.19-1.7-4.487-1.604-6.891a13.67 13.67 0 012.03-6.61c1.272-2.046 3.006-3.653 5.202-4.82z" fill="url(#paint0_linear)"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M18.425 107.787a4.74 4.74 0 001.836-1.714 4.894 4.894 0 00.746-2.372 4.587 4.587 0 00-.548-2.422 4.71 4.71 0 00-1.712-1.829 4.838 4.838 0 00-2.395-.728 4.739 4.739 0 00-2.447.563 4.611 4.611 0 00-1.814 1.703 4.892 4.892 0 00-.715 2.381 4.711 4.711 0 00.56 2.443c.625 1.177 1.568 1.957 2.829 2.341 1.26.383 2.48.261 3.66-.366zM9.822 91.606c2.196-1.168 4.498-1.707 6.905-1.617a13.67 13.67 0 016.616 2.013c2.046 1.265 3.651 2.993 4.816 5.183.888 1.67 1.495 3.806 1.822 6.407.261 2.214.328 4.724.201 7.531a89.025 89.025 0 01-.765 7.203 72.41 72.41 0 01-.956 5.354l-.471 2.095-2-.781a72.06 72.06 0 01-4.973-2.202 88.833 88.833 0 01-6.4-3.393c-2.398-1.464-4.442-2.924-6.13-4.379-1.974-1.725-3.405-3.422-4.293-5.092-1.165-2.191-1.7-4.488-1.604-6.891.11-2.377.786-4.58 2.03-6.611 1.272-2.046 3.006-3.653 5.202-4.82z" fill="#DBF5D6"></path><path d="M16.727 89.989l.02-.45h-.004l-.016.45zm6.616 2.013l.237-.383-.003-.001-.234.384zm6.638 11.59l.447-.053v-.003l-.447.056zm.201 7.531l.45.028v-.008l-.45-.02zm-.765 7.203l-.446-.065v.002l.446.063zm-.956 5.354l.439.099v-.003l-.439-.096zm-.471 2.095l-.164.419.488.19.115-.511-.439-.098zm-2-.781l-.166.418.003.001.163-.419zm-4.973-2.202l.197-.404-.002-.001-.195.405zm-6.4-3.393l-.234.384.006.004.228-.388zm-6.13-4.379l-.297.339.003.002.293-.341zM2.59 103.037l-.45-.021v.003l.45.018zm2.03-6.611l-.382-.238-.001.003.383.235zm14.017 11.758a5.191 5.191 0 002.006-1.874l-.764-.474a4.293 4.293 0 01-1.665 1.553l.423.795zm2.006-1.874a5.342 5.342 0 00.813-2.587l-.898-.044a4.446 4.446 0 01-.68 2.157l.765.474zm.813-2.587a5.036 5.036 0 00-.6-2.655l-.795.423c.37.696.535 1.423.497 2.188l.898.044zm-.6-2.655a5.16 5.16 0 00-1.873-2l-.473.765c.666.411 1.181.961 1.551 1.658l.795-.423zm-1.873-2a5.287 5.287 0 00-2.614-.796l-.034.9c.785.03 1.508.25 2.175.661l.473-.766zm-2.614-.796a5.189 5.189 0 00-2.675.616l.423.795a4.29 4.29 0 012.218-.512l.034-.899zm-2.675.616a5.065 5.065 0 00-1.988 1.866l.769.467a4.167 4.167 0 011.642-1.538l-.423-.795zm-1.988 1.866a5.346 5.346 0 00-.78 2.597l.9.037a4.449 4.449 0 01.649-2.167l-.77-.467zm-.78 2.597a5.16 5.16 0 00.612 2.672l.794-.423a4.254 4.254 0 01-.506-2.212l-.9-.037zm.612 2.672c.681 1.281 1.72 2.141 3.095 2.56l.263-.861c-1.145-.348-1.993-1.049-2.564-2.122l-.794.423zm3.095 2.56c1.377.419 2.72.283 4.004-.399l-.423-.795c-1.077.573-2.174.681-3.318.333l-.263.861zm-4.6-16.58c2.129-1.132 4.352-1.651 6.677-1.565l.033-.899c-2.489-.093-4.869.465-7.132 1.67l.422.794zm6.674-1.565a13.22 13.22 0 016.402 1.948l.468-.768a14.12 14.12 0 00-6.83-2.079l-.04.9zm6.4 1.947c1.975 1.222 3.526 2.89 4.655 5.011l.794-.422c-1.2-2.258-2.86-4.046-4.976-5.355l-.474.766zm4.655 5.011c.854 1.608 1.45 3.686 1.772 6.252l.893-.112c-.33-2.636-.95-4.829-1.87-6.562l-.795.422zm1.772 6.248c.258 2.185.325 4.67.199 7.459l.899.04c.128-2.825.06-5.361-.204-7.604l-.894.105zm.2 7.451a88.48 88.48 0 01-.763 7.166l.891.129c.371-2.56.628-4.973.77-7.239l-.899-.056zm-.763 7.168a72.001 72.001 0 01-.95 5.322l.88.191c.39-1.798.71-3.594.962-5.388l-.892-.125zm-.949 5.319l-.471 2.094.878.197.471-2.094-.878-.197zm.132 1.773l-2-.78-.327.838 2 .781.327-.839zm-1.997-.779a72.129 72.129 0 01-4.943-2.188l-.395.808a72.956 72.956 0 005.005 2.216l.333-.836zm-4.945-2.189a88.618 88.618 0 01-6.367-3.376l-.456.776a89.03 89.03 0 006.432 3.41l.391-.81zm-6.36-3.372c-2.383-1.455-4.405-2.9-6.072-4.335l-.587.681c1.711 1.475 3.776 2.948 6.19 4.422l.469-.768zm-6.07-4.333c-1.947-1.702-3.336-3.358-4.19-4.966l-.796.423c.922 1.733 2.394 3.472 4.394 5.22l.592-.677zm-4.19-4.966c-1.13-2.122-1.645-4.34-1.553-6.661l-.899-.036c-.098 2.486.456 4.862 1.656 7.12l.795-.423zm-1.553-6.659c.107-2.3.76-4.43 1.965-6.396l-.767-.47a14.12 14.12 0 00-2.097 6.825l.9.041zm1.964-6.394c1.228-1.976 2.902-3.528 5.03-4.66l-.422-.795c-2.264 1.204-4.058 2.865-5.373 4.98l.765.475z" fill="#2DAA2A"></path><path d="M137.218 66.533a1.8 1.8 0 012.205-1.273l55.807 14.953a1.8 1.8 0 011.273 2.205l-13.971 52.139a1.799 1.799 0 01-2.204 1.272l-55.807-14.953a1.799 1.799 0 01-1.273-2.205l13.97-52.138z" fill="url(#paint1_linear)"></path><path d="M141.69 62.68a2.25 2.25 0 00-2.756 1.591l-13.97 52.139a2.25 2.25 0 001.591 2.755l55.807 14.954a2.251 2.251 0 002.756-1.591l13.97-52.139a2.25 2.25 0 00-1.591-2.755L141.69 62.68z" fill="#fff" stroke="#DBF5D6" stroke-width=".9" stroke-linecap="round" stroke-linejoin="round"></path><path d="M143.902 68.395l49.694 13.316-8.848 33.022-49.694-13.316 8.848-33.022z" fill="#DBF5D6"></path><circle cx="152.395" cy="82.457" r="5.294" transform="rotate(15 152.395 82.457)" fill="#B9EDB6"></circle><path d="M133.89 105.762l49.694 13.316-.931 3.476-49.695-13.316.932-3.476zM132.027 112.714l28.77 7.709-.931 3.476-28.771-7.709.932-3.476zM135.074 101.414l23.038-10.695 9.689 12.753 11.976-4.29 6.498 9.94-1.54 5.637-49.661-13.345z" fill="#B9EDB6"></path><defs><linearGradient id="paint0_linear" x1="-24.216" y1="91.619" x2="20.759" y2="136.261" gradientUnits="userSpaceOnUse"><stop stop-color="#fff" stop-opacity=".01"></stop><stop offset="1" stop-color="#DBF5D6"></stop></linearGradient><linearGradient id="paint1_linear" x1="119.419" y1="62.559" x2="127.576" y2="152.876" gradientUnits="userSpaceOnUse"><stop stop-color="#fff" stop-opacity=".01"></stop><stop offset="1" stop-color="#2DAA2A"></stop></linearGradient></defs></svg>
  <div>
    <p>
      Collection of past activities &amp; events hosted by the community during previous editions of Open Education Week.
    </p>
  </div>
</div>

<form method="get" onchange="this.submit()">
  <div class="grid gird-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-2 md:gap-x-4 gap-y-6 bg-green-600 text-white mb-4 p-4">
    <div>
      {{ filter.form.language.label_tag }}
      {{ filter.form.language }}
    </div>
    <div>
      {{ filter.form.year.label_tag }}
      {{ filter.form.year }}
    </div>
    <noscript>
      <div>
        <input type="submit" value="Filter" class="button-outline font-bold">
      </div>
    </noscript>
  </div>
</form>

<p>
  <form hx-post="{% if reload_after_timezone_change %}{% url 'set_timezone_reload' %}{% else %}{% url 'set_timezone' %}{% endif %}"
        hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
        hx-trigger="change" hx-target="#timezone_result">
      <i class="fal fa-clock"></i> <strong>current time: <span style='background-color: #ffffcc;'>{{ current_time_utc | date:'M d, Y H:i' }}</span></strong>
      <select name="timezone" class="px-3 py-2 rounded-lg">
          {% for tz in timezones %}
          <option value="{{ tz }}"{% if tz == current_timezone %} selected{% endif %}>{{ tz }}</option>
          {% endfor %}
      </select>
      (UTC time: {{ current_time_utc | utc | date:'M d, Y H:i' }})
  </form>
</p>
<div class="hidden" id="timezone_result">/{{ current_timezone }}/</div>

{% if event_count %}
    <p><i class="fal fa-calculator"></i> <strong>Showing {{ event_count }} events</strong></p>
    <br>
{% endif %}

<div class="grid gird-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 md:gap-x-4 gap-y-6">

    {% for event in event_list %}

        <div class="bg-white mb-2 rounded-lg shadow-sm transition-shadow overflow-hidden hover:shadow-lg border-2 border-gray-200 hover:border-purple-500">

            <div class="item-media">
                {% if event.consolidated_image_url_list %}
                <a href="/events/{{event.year}}/{{event.slug}}/"><img loading="lazy" src="{{ event.consolidated_image_url_list }}" class="object-cover w-full h-40"></a>
                {% else %}
                    {% load static %}
                    <a href="/events/{{event.year}}/{{event.slug}}/"><img rel="stylesheet" src="{% static 'web/images/placeholder-asset-sm.png' %}" class="object-cover w-full h-40"></a>
                {% endif %}
            </div>
            <div class="p-4">
                <h3 class="text-base leading-tight mb-2">
                    <a href="/events/{{event.year}}/{{event.slug}}/">
                        <span class="hidden">#{{ forloop.counter }}.</span>
                        <span class="font-bold">{{ event.title }}</span>
                    </a>
                </h3>
                <p class="text-sm"><i class="fal fa-university"></i> {{ event.institution }}</p>

                {% if event.institution_is_oeg_member %}
                <p class="text-sm mb-1"><i class="fal fa-badge-check"></i><span style="background-color: #ffffcc;"> OEGlobal member<span></p>
                {% endif %}

                <p class="text-sm mb-1"><i class="fal fa-globe-asia"></i> {{ event.country }}, {{ event.city }}</p>

                <p class="text-sm mb-1">
                    <i class="fal fa-calendar-star"></i> {{ event.event_time|date:'M d, Y H:i' }} <em>({{ current_timezone }})</em>
                    {% if event.event_offset_in_hours %}
                        <span style="color: #cc0000;">&nbsp;
                        {{ event.event_offset_in_hours }}
                        </span>
                    {% endif %}

                    {% if event.event_time_link_to_everytimezone %}
                        <span style="color: #999999;">&nbsp;
                        <em><a href="{{ event.event_time_link_to_everytimezone }}" target="_blank">(view in other timezones)</a></em>
                        </span>
                    {% endif %}
                </p>
            </div>
        </div>

    {% endfor %}

</div>

{% endblock %}
